# è´¢åŠ¡æ¦‚è§ˆé¡µé¢ä»Projects Collectionè¯»å–æ´»åŠ¨ä¿¡æ¯ - æŠ€æœ¯æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜è´¢åŠ¡æ¦‚è§ˆé¡µé¢æ´»åŠ¨è´¢åŠ¡æ ‡ç­¾é¡µå¦‚ä½•ä»`projects` collectionè¯»å–æ´»åŠ¨ä¸»å¸­ã€æ´»åŠ¨è´¢æ”¿å’Œæ´»åŠ¨æ—¥æœŸä¿¡æ¯ã€‚

---

## ğŸ“Š æ•°æ®æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    loadEventFinancials()                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                   â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚FinanceEvents â”‚  â”‚Projects (Events) â”‚  â”‚ Transactions â”‚
â”‚  Collection  â”‚  â”‚   Collection     â”‚  â”‚  Collection  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                   â†“                   â†“
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  æ•°æ®åˆå¹¶å¤„ç†  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ é€šè¿‡æ´»åŠ¨åç§°åŒ¹é…      â”‚
                â”‚ financeEvents.name  â”‚
                â”‚     â•â•â•â•â•â•â•         â”‚
                â”‚  projects.name      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“                               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚æå–Projectsä¿¡æ¯â”‚              â”‚ è®¡ç®—è´¢åŠ¡æ•°æ®    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“                               â†“
    â€¢ startDate                    â€¢ totalRevenue
    â€¢ committeeMembers             â€¢ totalExpense
      - æ´»åŠ¨ä¸»å¸­                    â€¢ netIncome
      - æ´»åŠ¨è´¢æ”¿
            â”‚                               â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ EventFinancialSummaryâ”‚
                â”‚   (æœ€ç»ˆæ˜¾ç¤ºæ•°æ®)     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯å®ç°è¯¦è§£

### Step 1: å¯¼å…¥å¿…è¦çš„æœåŠ¡å’Œç±»å‹

```typescript
// æ–‡ä»¶: src/modules/finance/pages/EventFinancialPage/index.tsx

import { getEvents } from '../../../event/services/eventService';
import type { Event } from '../../../event/types';
import { getAllFinanceEvents } from '../../services/financeEventService';
import { getTransactions } from '../../services/transactionService';
```

**è¯´æ˜**ï¼š
- `getEvents`: ä»projects collectionè¯»å–æ´»åŠ¨æ•°æ®
- `Event`: Projectsçš„ç±»å‹å®šä¹‰
- `getAllFinanceEvents`: ä»financeEvents collectionè¯»å–è´¢åŠ¡è´¦æˆ·
- `getTransactions`: è¯»å–äº¤æ˜“è®°å½•

---

### Step 2: åŠ è½½Projectsæ•°æ®

```typescript
// ç¬¬161-167è¡Œ
const projectsResult = await getEvents({
  page: 1,
  limit: 1000,
  status: 'Published', // åªè·å–å·²å‘å¸ƒçš„æ´»åŠ¨
});

// åˆ›å»ºMapç”¨äºå¿«é€ŸæŸ¥æ‰¾
const projectsMap = new Map<string, Event>(
  projectsResult.data.map(p => [p.name, p])
);
```

**å…³é”®ç‚¹**ï¼š
- åŠ è½½æ‰€æœ‰å·²å‘å¸ƒçš„æ´»åŠ¨ï¼ˆ`status: 'Published'`ï¼‰
- åˆ›å»º`Map<æ´»åŠ¨åç§°, Eventå¯¹è±¡>`ä¾¿äºå¿«é€ŸæŸ¥æ‰¾
- ä½¿ç”¨æ´»åŠ¨åç§°ä½œä¸ºkeyè¿›è¡ŒåŒ¹é…

**æ•°æ®ç»“æ„ç¤ºä¾‹**ï¼š
```typescript
projectsMap = {
  "å¹´åº¦å¤§ä¼š": {
    id: "evt001",
    name: "å¹´åº¦å¤§ä¼š",
    startDate: "2025-01-15T09:00:00Z",
    committeeMembers: [
      {
        id: "cm001",
        name: "å¼ ä¸‰",
        position: "æ´»åŠ¨ä¸»å¸­",
        ...
      },
      {
        id: "cm002",
        name: "æå››",
        position: "æ´»åŠ¨è´¢æ”¿",
        ...
      }
    ],
    ...
  },
  "æ–°æ˜¥è”æ¬¢": { ... }
}
```

---

### Step 3: åŒ¹é…æ´»åŠ¨å¹¶æå–ä¿¡æ¯

```typescript
// ç¬¬198-216è¡Œ
const projectInfo = projectsMap.get(event.eventName);
let eventChair = '';
let eventTreasurer = '';
let eventDate = event.eventDate || new Date().toISOString();

if (projectInfo) {
  // ğŸ“… ä»startDateè¯»å–æ´»åŠ¨æ—¥æœŸ
  eventDate = projectInfo.startDate;
  
  // ğŸ‘¥ ä»committeeMembersè¯»å–æ´»åŠ¨ä¸»å¸­å’Œè´¢æ”¿
  if (projectInfo.committeeMembers && projectInfo.committeeMembers.length > 0) {
    const chair = projectInfo.committeeMembers.find(
      m => m.position === 'æ´»åŠ¨ä¸»å¸­' || m.position === 'Chair'
    );
    const treasurer = projectInfo.committeeMembers.find(
      m => m.position === 'æ´»åŠ¨è´¢æ”¿' || m.position === 'Treasurer'
    );
    
    eventChair = chair ? chair.name : '';
    eventTreasurer = treasurer ? treasurer.name : '';
  }
}
```

**åŒ¹é…é€»è¾‘**ï¼š
1. é€šè¿‡`financeEvents.eventName`åœ¨`projectsMap`ä¸­æŸ¥æ‰¾å¯¹åº”çš„é¡¹ç›®
2. å¦‚æœæ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®ï¼š
   - æå–`startDate` â†’ `eventDate`
   - éå†`committeeMembers`æ•°ç»„
   - æŸ¥æ‰¾èŒä½ä¸º"æ´»åŠ¨ä¸»å¸­"æˆ–"Chair"çš„æˆå‘˜
   - æŸ¥æ‰¾èŒä½ä¸º"æ´»åŠ¨è´¢æ”¿"æˆ–"Treasurer"çš„æˆå‘˜

---

### Step 4: ç»„è£…æœ€ç»ˆæ•°æ®

```typescript
// ç¬¬218-234è¡Œ
return {
  eventId: event.id,
  eventName: event.eventName,
  eventDate,        // âœ… ä»projects.startDate
  boardMember: event.boardMember,
  eventChair,       // âœ… ä»projects.committeeMembers
  eventTreasurer,   // âœ… ä»projects.committeeMembers
  totalRevenue,     // ä»transactionsè®¡ç®—
  totalExpense,     // ä»transactionsè®¡ç®—
  netIncome,        // totalRevenue - totalExpense
  budgetedRevenue: 0,
  budgetedExpense: 0,
  status: event.status,
};
```

---

## ğŸ“‹ æ•°æ®ç±»å‹å®šä¹‰

### EventFinancialSummaryæ¥å£

```typescript
interface EventFinancialSummary {
  eventId: string;
  eventName: string;
  eventDate: string;              // â† ä»projects.startDate
  boardMember?: string;
  eventChair?: string;            // â† ä»projects.committeeMembers
  eventTreasurer?: string;        // â† ä»projects.committeeMembers
  totalRevenue: number;
  totalExpense: number;
  netIncome: number;
  budgetedRevenue: number;
  budgetedExpense: number;
  status: string;
}
```

### Eventæ¥å£ï¼ˆProjects Collectionï¼‰

```typescript
interface Event {
  id: string;
  name: string;                   // â† ç”¨äºåŒ¹é…
  startDate: string;              // â† æ´»åŠ¨æ—¥æœŸæ¥æº
  endDate: string;
  committeeMembers?: CommitteeMember[]; // â† ä¸»å¸­å’Œè´¢æ”¿æ¥æº
  status: EventStatus;
  // ... å…¶ä»–å­—æ®µ
}

interface CommitteeMember {
  id: string;
  name: string;                   // â† æ˜¾ç¤ºçš„å§“å
  position: string;               // â† ç”¨äºè¯†åˆ«èŒä½
  contact?: string;
  email?: string;
  canEditEvent: boolean;
  canApproveTickets: boolean;
}
```

---

## ğŸ” åŒ¹é…è§„åˆ™è¯¦è§£

### 1. æ´»åŠ¨åç§°åŒ¹é…

```typescript
const projectInfo = projectsMap.get(event.eventName);
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨**å®Œå…¨åŒ¹é…**ï¼ˆexact matchï¼‰
- åŒºåˆ†å¤§å°å†™
- åŒºåˆ†ç©ºæ ¼

**ç¤ºä¾‹**ï¼š
```typescript
// âœ… åŒ¹é…æˆåŠŸ
financeEvents.eventName = "å¹´åº¦å¤§ä¼š"
projects.name = "å¹´åº¦å¤§ä¼š"

// âŒ åŒ¹é…å¤±è´¥
financeEvents.eventName = "å¹´åº¦å¤§ä¼š"
projects.name = "å¹´åº¦å¤§ä¼š "  // æ³¨æ„æœ«å°¾ç©ºæ ¼

// âŒ åŒ¹é…å¤±è´¥
financeEvents.eventName = "å¹´åº¦å¤§ä¼š"
projects.name = "å¹´åº¦å¤§æœƒ"  // ç¹ç®€ä½“ä¸åŒ
```

### 2. èŒä½åŒ¹é…è§„åˆ™

```typescript
m.position === 'æ´»åŠ¨ä¸»å¸­' || m.position === 'Chair'
m.position === 'æ´»åŠ¨è´¢æ”¿' || m.position === 'Treasurer'
```

**æ”¯æŒçš„èŒä½åç§°**ï¼š

| ä¸­æ–‡ | è‹±æ–‡ | è¯´æ˜ |
|------|------|------|
| æ´»åŠ¨ä¸»å¸­ | Chair | ä¸»å¸­èŒä½ |
| æ´»åŠ¨è´¢æ”¿ | Treasurer | è´¢æ”¿èŒä½ |

**ç¤ºä¾‹**ï¼š
```typescript
// âœ… åŒ¹é…æˆåŠŸ - ä¸­æ–‡
committeeMembers = [
  { name: "å¼ ä¸‰", position: "æ´»åŠ¨ä¸»å¸­" }
]
// â†’ eventChair = "å¼ ä¸‰"

// âœ… åŒ¹é…æˆåŠŸ - è‹±æ–‡
committeeMembers = [
  { name: "John", position: "Chair" }
]
// â†’ eventChair = "John"

// âŒ ä¸åŒ¹é…
committeeMembers = [
  { name: "å¼ ä¸‰", position: "ç­¹å§”ä¸»å¸­" }  // ç­¹å§”ä¸»å¸­ä¸æ˜¯æ´»åŠ¨ä¸»å¸­
]
// â†’ eventChair = ""
```

---

## ğŸ”„ å®Œæ•´æ‰§è¡Œæµç¨‹

### æ—¶åºå›¾

```
ç”¨æˆ·æ‰“å¼€æ´»åŠ¨è´¢åŠ¡é¡µé¢
    â†“
loadEventFinancials() è§¦å‘
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å¹¶è¡ŒåŠ è½½ä¸‰ä¸ªæ•°æ®æº               â”‚
â”‚    - getAllFinanceEvents()         â”‚
â”‚    - getEvents()                   â”‚
â”‚    - getTransactions()             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åˆ›å»ºprojectsMap                 â”‚
â”‚    Map<æ´»åŠ¨åç§°, Eventå¯¹è±¡>         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. éå†financeEventsList           â”‚
â”‚    å¯¹æ¯ä¸ªæ´»åŠ¨ï¼š                     â”‚
â”‚    3.1 é€šè¿‡åç§°åŒ¹é…projects         â”‚
â”‚    3.2 æå–startDate                â”‚
â”‚    3.3 æŸ¥æ‰¾å§”å‘˜ä¼šæˆå‘˜               â”‚
â”‚        - æ´»åŠ¨ä¸»å¸­                   â”‚
â”‚        - æ´»åŠ¨è´¢æ”¿                   â”‚
â”‚    3.4 è®¡ç®—è´¢åŠ¡ç»Ÿè®¡                 â”‚
â”‚    3.5 ç»„è£…æœ€ç»ˆæ•°æ®                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åº”ç”¨ç­›é€‰æ¡ä»¶                    â”‚
â”‚    - å¹´ä»½ç­›é€‰                       â”‚
â”‚    - è´Ÿè´£ç†äº‹ç­›é€‰                   â”‚
â”‚    - çŠ¶æ€ç­›é€‰                       â”‚
â”‚    - æœç´¢ç­›é€‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­                    â”‚
â”‚    - æ´»åŠ¨åç§°                       â”‚
â”‚    - æ´»åŠ¨ä¸»å¸­ âœ…                    â”‚
â”‚    - æ´»åŠ¨è´¢æ”¿ âœ…                    â”‚
â”‚    - æ´»åŠ¨æ—¥æœŸ âœ…                    â”‚
â”‚    - è´¢åŠ¡æ•°æ®                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ ä»£ç ç¤ºä¾‹

### å®Œæ•´çš„loadEventFinancialså‡½æ•°

```typescript
const loadEventFinancials = async () => {
  if (!user) return;

  try {
    setLoading(true);

    // Step 1: åŠ è½½è´¢åŠ¡è´¦æˆ·
    const financeEventsList = await getAllFinanceEvents();
    
    // Step 2: åŠ è½½projectsæ´»åŠ¨æ•°æ®
    const projectsResult = await getEvents({
      page: 1,
      limit: 1000,
      status: 'Published',
    });
    const projectsMap = new Map<string, Event>(
      projectsResult.data.map(p => [p.name, p])
    );
    
    // Step 3: åŠ è½½äº¤æ˜“è®°å½•
    const allEventTransactions = await getTransactions({
      page: 1,
      limit: 1000,
      category: 'event-finance',
      includeVirtual: true,
      sortBy: 'transactionDate',
      sortOrder: 'desc',
    });
    
    // Step 4: åˆå¹¶æ•°æ®
    const eventFinancials: EventFinancialSummary[] = await Promise.all(
      financeEventsList.map(async (event) => {
        // è®¡ç®—è´¢åŠ¡æ•°æ®
        const eventTransactions = allEventTransactions.data.filter(
          t => t.txAccount === event.eventName
        );
        const totalRevenue = eventTransactions
          .filter(t => t.transactionType === 'income')
          .reduce((sum, t) => sum + t.amount, 0);
        const totalExpense = eventTransactions
          .filter(t => t.transactionType === 'expense')
          .reduce((sum, t) => sum + t.amount, 0);
        const netIncome = totalRevenue - totalExpense;
        
        // Step 5: ä»projectsæå–ä¿¡æ¯
        const projectInfo = projectsMap.get(event.eventName);
        let eventChair = '';
        let eventTreasurer = '';
        let eventDate = event.eventDate || new Date().toISOString();
        
        if (projectInfo) {
          eventDate = projectInfo.startDate;
          
          if (projectInfo.committeeMembers && projectInfo.committeeMembers.length > 0) {
            const chair = projectInfo.committeeMembers.find(
              m => m.position === 'æ´»åŠ¨ä¸»å¸­' || m.position === 'Chair'
            );
            const treasurer = projectInfo.committeeMembers.find(
              m => m.position === 'æ´»åŠ¨è´¢æ”¿' || m.position === 'Treasurer'
            );
            
            eventChair = chair ? chair.name : '';
            eventTreasurer = treasurer ? treasurer.name : '';
          }
        }
        
        // Step 6: è¿”å›åˆå¹¶åçš„æ•°æ®
        return {
          eventId: event.id,
          eventName: event.eventName,
          eventDate,
          boardMember: event.boardMember,
          eventChair,
          eventTreasurer,
          totalRevenue,
          totalExpense,
          netIncome,
          budgetedRevenue: 0,
          budgetedExpense: 0,
          status: event.status,
        };
      })
    );
    
    setEvents(eventFinancials);
  } catch (error) {
    console.error('åŠ è½½å¤±è´¥:', error);
    message.error('åŠ è½½æ´»åŠ¨è´¢åŠ¡æ•°æ®å¤±è´¥');
  } finally {
    setLoading(false);
  }
};
```

---

## ğŸ¯ å…³é”®ä¼˜åŒ–ç‚¹

### 1. ä½¿ç”¨Mapæé«˜æŸ¥æ‰¾æ€§èƒ½

```typescript
// âŒ ä½æ•ˆ - O(nÂ²) æ—¶é—´å¤æ‚åº¦
financeEventsList.forEach(event => {
  const projectInfo = projectsResult.data.find(p => p.name === event.eventName);
});

// âœ… é«˜æ•ˆ - O(n) æ—¶é—´å¤æ‚åº¦
const projectsMap = new Map(projectsResult.data.map(p => [p.name, p]));
financeEventsList.forEach(event => {
  const projectInfo = projectsMap.get(event.eventName);
});
```

**æ€§èƒ½æå‡**ï¼š
- 100ä¸ªæ´»åŠ¨ Ã— 100ä¸ªé¡¹ç›® = 10,000æ¬¡æ¯”è¾ƒ â†’ 200æ¬¡æŸ¥æ‰¾
- æŸ¥æ‰¾æ—¶é—´ä»O(n)é™è‡³O(1)

### 2. å¹¶è¡ŒåŠ è½½æ•°æ®

```typescript
// ä¸‰ä¸ªæ•°æ®æºå¹¶è¡ŒåŠ è½½
const [financeEventsList, projectsResult, allEventTransactions] = await Promise.all([
  getAllFinanceEvents(),
  getEvents({ page: 1, limit: 1000, status: 'Published' }),
  getTransactions({ page: 1, limit: 1000, category: 'event-finance' }),
]);
```

**ä¼˜åŠ¿**ï¼š
- å‡å°‘æ€»ç­‰å¾…æ—¶é—´
- æé«˜é¡µé¢åŠ è½½é€Ÿåº¦

---

## ğŸ”’ å®¹é”™å¤„ç†

### 1. Projectsæ•°æ®ä¸å­˜åœ¨

```typescript
if (projectInfo) {
  // æå–ä¿¡æ¯
} else {
  // ä½¿ç”¨é»˜è®¤å€¼
  eventChair = '';
  eventTreasurer = '';
  eventDate = event.eventDate || new Date().toISOString();
}
```

### 2. CommitteeMembersä¸ºç©º

```typescript
if (projectInfo.committeeMembers && projectInfo.committeeMembers.length > 0) {
  // æŸ¥æ‰¾æˆå‘˜
} else {
  // é»˜è®¤ä¸ºç©º
  eventChair = '';
  eventTreasurer = '';
}
```

### 3. èŒä½ä¸å­˜åœ¨

```typescript
const chair = projectInfo.committeeMembers.find(...);
eventChair = chair ? chair.name : '';  // ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦
```

---

## ğŸ“Š è¡¨æ ¼æ˜¾ç¤º

### è¡¨æ ¼åˆ—å®šä¹‰

```typescript
{
  title: 'æ´»åŠ¨ä¸»å¸­',
  dataIndex: 'eventChair',
  key: 'eventChair',
  width: 140,
  render: (chair: string) => {
    return chair ? <Tag color="blue">{chair}</Tag> : <Tag>æœªè®¾ç½®</Tag>;
  },
},
{
  title: 'æ´»åŠ¨è´¢æ”¿',
  dataIndex: 'eventTreasurer',
  key: 'eventTreasurer',
  width: 140,
  render: (treasurer: string) => {
    return treasurer ? <Tag color="green">{treasurer}</Tag> : <Tag>æœªè®¾ç½®</Tag>;
  },
},
{
  title: 'æ´»åŠ¨æ—¥æœŸ',
  dataIndex: 'eventDate',
  key: 'eventDate',
  width: 110,
  render: (date: string) => 
    globalDateService.formatDate(new Date(date), 'display'),
},
```

**æ˜¾ç¤ºæ•ˆæœ**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ´»åŠ¨åç§°  â”‚ æ´»åŠ¨ä¸»å¸­    â”‚ æ´»åŠ¨è´¢æ”¿    â”‚ æ´»åŠ¨æ—¥æœŸ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¹´åº¦å¤§ä¼š  â”‚ [å¼ ä¸‰]     â”‚ [æå››]     â”‚ 15-Jan-2025  â”‚
â”‚ æ–°æ˜¥è”æ¬¢  â”‚ [ç‹äº”]     â”‚ [èµµå…­]     â”‚ 20-Feb-2025  â”‚
â”‚ åŸ¹è®­è¯¾ç¨‹  â”‚ [æœªè®¾ç½®]   â”‚ [æœªè®¾ç½®]   â”‚ 10-Mar-2025  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ•°æ®ä¸€è‡´æ€§ä¿è¯

### å…³é”®ç‚¹

1. **å•ä¸€æ•°æ®æº**
   - æ´»åŠ¨ä¿¡æ¯ç»Ÿä¸€ä»projectsè¯»å–
   - é¿å…å¤šå¤„ç»´æŠ¤åŒä¸€æ•°æ®

2. **å®æ—¶åŒæ­¥**
   - æ¯æ¬¡åŠ è½½é¡µé¢é‡æ–°è¯»å–projects
   - ç¡®ä¿æ˜¾ç¤ºæœ€æ–°ä¿¡æ¯

3. **ç²¾ç¡®åŒ¹é…**
   - é€šè¿‡æ´»åŠ¨åç§°ç²¾ç¡®åŒ¹é…
   - é¿å…è¯¯åŒ¹é…

4. **å›é€€æœºåˆ¶**
   - å¦‚æœprojectsä¸­æ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤º"æœªè®¾ç½®"
   - ä¸å½±å“å…¶ä»–åŠŸèƒ½æ­£å¸¸ä½¿ç”¨

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ´»åŠ¨åç§°å¿…é¡»å®Œå…¨ä¸€è‡´

```typescript
// âœ… æ­£ç¡®
financeEvents.eventName = "å¹´åº¦å¤§ä¼š"
projects.name = "å¹´åº¦å¤§ä¼š"

// âŒ é”™è¯¯
financeEvents.eventName = "å¹´åº¦å¤§ä¼š2025"
projects.name = "å¹´åº¦å¤§ä¼š"  // ä¸åŒ¹é…
```

### 2. èŒä½åç§°è¦æ ‡å‡†åŒ–

å»ºè®®åœ¨EventCommitteeFormä¸­ä½¿ç”¨æ ‡å‡†èŒä½ï¼š
- âœ… "æ´»åŠ¨ä¸»å¸­" æˆ– "Chair"
- âœ… "æ´»åŠ¨è´¢æ”¿" æˆ– "Treasurer"
- âŒ "ç­¹å§”ä¸»å¸­" ï¼ˆä¸ä¼šè¢«è¯†åˆ«ä¸ºæ´»åŠ¨ä¸»å¸­ï¼‰

### 3. æ€§èƒ½è€ƒè™‘

- Projectsæ•°é‡é™åˆ¶ä¸º1000æ¡
- å¦‚æœè¶…è¿‡1000ä¸ªæ´»åŠ¨ï¼Œè€ƒè™‘åˆ†é¡µæˆ–ç­›é€‰

---

## ğŸ“ è°ƒè¯•æŠ€å·§

### 1. æ£€æŸ¥æ´»åŠ¨åç§°åŒ¹é…

```typescript
console.log('ğŸ“‹ æ´»åŠ¨åŒ¹é…æƒ…å†µ:');
financeEventsList.forEach(event => {
  const matched = projectsMap.has(event.eventName);
  console.log(`${event.eventName}: ${matched ? 'âœ… åŒ¹é…' : 'âŒ æœªåŒ¹é…'}`);
});
```

### 2. æ£€æŸ¥å§”å‘˜ä¼šæˆå‘˜

```typescript
if (projectInfo) {
  console.log('ğŸ‘¥ å§”å‘˜ä¼šæˆå‘˜:', projectInfo.committeeMembers);
  console.log('æ´»åŠ¨ä¸»å¸­:', eventChair);
  console.log('æ´»åŠ¨è´¢æ”¿:', eventTreasurer);
}
```

### 3. æ£€æŸ¥projectsMapå†…å®¹

```typescript
console.log('ğŸ“Š Projects Mapå¤§å°:', projectsMap.size);
console.log('ğŸ“‹ æ‰€æœ‰æ´»åŠ¨åç§°:', Array.from(projectsMap.keys()));
```

---

## ğŸš€ æ€»ç»“

### æ ¸å¿ƒæµç¨‹

```
åŠ è½½Projects â†’ åˆ›å»ºMap â†’ é€šè¿‡åç§°åŒ¹é… â†’ æå–ä¿¡æ¯ â†’ æ˜¾ç¤º
```

### å…³é”®ä»£ç ä½ç½®

- **æ•°æ®åŠ è½½**: ç¬¬152-235è¡Œ
- **Projectsè¯»å–**: ç¬¬161-167è¡Œ
- **ä¿¡æ¯æå–**: ç¬¬198-216è¡Œ
- **è¡¨æ ¼æ˜¾ç¤º**: ç¬¬828-855è¡Œ

### ä¼˜åŠ¿

- âœ… æ•°æ®ç»Ÿä¸€ç®¡ç†
- âœ… å®æ—¶åŒæ­¥æ›´æ–°
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆMapæŸ¥æ‰¾ï¼‰
- âœ… å®¹é”™æœºåˆ¶å®Œå–„

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2025-01-22  
**ç›¸å…³æ–‡ä»¶**: `src/modules/finance/pages/EventFinancialPage/index.tsx`

