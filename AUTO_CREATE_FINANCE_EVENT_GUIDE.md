# ğŸ”— è‡ªåŠ¨åˆ›å»ºè´¢åŠ¡è´¦æˆ·åŠŸèƒ½æŒ‡å—

**å®æ–½æ—¥æœŸ**: 2025-01-18  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

åœ¨åˆ›å»ºæ´»åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼š**è‡ªåŠ¨åˆ›å»ºå…³è”çš„è´¢åŠ¡è´¦æˆ·ï¼ˆFinanceEventï¼‰**ï¼Œå¹¶å»ºç«‹åŒå‘å…³è”ã€‚

---

## ğŸš€ å·¥ä½œæµç¨‹

### ä¹‹å‰çš„æµç¨‹ âŒ
```
1. åˆ›å»ºæ´»åŠ¨ï¼ˆEventï¼‰
2. æ‰‹åŠ¨å»"è´¢åŠ¡ç®¡ç† â†’ æ´»åŠ¨è´¢åŠ¡"åˆ›å»ºè´¢åŠ¡è´¦æˆ·
3. è¿”å›"æ´»åŠ¨ç®¡ç† â†’ ç¼–è¾‘æ´»åŠ¨ â†’ è´¹ç”¨è®¾ç½®"
4. æ‰‹åŠ¨é€‰æ‹©è´¢åŠ¡è´¦æˆ·
5. ä¿å­˜
```
**æ­¥éª¤**: 5æ­¥  
**è€—æ—¶**: çº¦3-5åˆ†é’Ÿ  
**å®¹æ˜“é—å¿˜**: âš ï¸ æ˜¯

---

### ç°åœ¨çš„æµç¨‹ âœ…
```
1. åˆ›å»ºæ´»åŠ¨ï¼ˆEventï¼‰
   â†“ ç³»ç»Ÿè‡ªåŠ¨
2. åˆ›å»ºè´¢åŠ¡è´¦æˆ·ï¼ˆFinanceEventï¼‰âœ…
3. å»ºç«‹åŒå‘å…³è” âœ…
```
**æ­¥éª¤**: 1æ­¥  
**è€—æ—¶**: çº¦30ç§’  
**è‡ªåŠ¨å®Œæˆ**: âœ… æ˜¯

---

## ğŸ”— åŒå‘å…³è”è®¾è®¡

### Event â†’ FinanceEvent
```typescript
Event {
  id: "event-123",
  name: "Hope For Nature 6.0",
  
  // å…³è”åˆ°è´¢åŠ¡è´¦æˆ·
  financialAccount: "finance-event-456",       // FinanceEvent.id
  financialAccountName: "Hope For Nature 6.0", // FinanceEvent.eventName
}
```

### FinanceEvent â†’ Event
```typescript
FinanceEvent {
  id: "finance-event-456",
  eventName: "Hope For Nature 6.0",
  
  // ğŸ†• åå‘å…³è”
  relatedEventId: "event-123",       // Event.id
  relatedEventName: "Hope For Nature 6.0", // Event.name
}
```

---

## ğŸ“Š è‡ªåŠ¨åˆ›å»ºçš„è´¢åŠ¡è´¦æˆ·è¯¦æƒ…

### é»˜è®¤å€¼è®¾ç½®

```typescript
FinanceEvent {
  eventName: Event.name,           // ä»æ´»åŠ¨åç§°è·å–
  eventDate: Event.startDate,      // ä»æ´»åŠ¨å¼€å§‹æ—¥æœŸè·å–
  description: Event.description || `${Event.name} æ´»åŠ¨è´¢åŠ¡è´¦æˆ·`,
  boardMember: 'president',        // é»˜è®¤ä¸ºä¸»å¸­ï¼ˆå¯åç»­ä¿®æ”¹ï¼‰
  status: 'planned',               // é»˜è®¤çŠ¶æ€ä¸ºè®¡åˆ’ä¸­
  
  // åŒå‘å…³è”
  relatedEventId: Event.id,
  relatedEventName: Event.name,
}
```

---

## ğŸ”„ å®Œæ•´çš„æ•°æ®æµ

```
ç”¨æˆ·åˆ›å»ºæ´»åŠ¨
    â†“
1. åˆ›å»º Event æ–‡æ¡£
   â””â”€ Event.id = "event-123"
    â†“
2. è‡ªåŠ¨åˆ›å»º FinanceEvent æ–‡æ¡£
   â”œâ”€ FinanceEvent.eventName = Event.name
   â”œâ”€ FinanceEvent.relatedEventId = Event.id
   â””â”€ FinanceEvent.id = "finance-event-456"
    â†“
3. æ›´æ–° Event æ–‡æ¡£
   â”œâ”€ Event.financialAccount = "finance-event-456"
   â””â”€ Event.financialAccountName = Event.name
    â†“
å®Œæˆï¼šåŒå‘å…³è”å·²å»ºç«‹ âœ…
```

---

## ğŸ’¡ ä¼˜åŠ¿

### 1. è‡ªåŠ¨åŒ–
- âœ… æ— éœ€æ‰‹åŠ¨åˆ›å»ºè´¢åŠ¡è´¦æˆ·
- âœ… æ— éœ€æ‰‹åŠ¨é€‰æ‹©å…³è”
- âœ… å‡å°‘æ“ä½œæ­¥éª¤

### 2. ä¸€è‡´æ€§
- âœ… åç§°è‡ªåŠ¨åŒæ­¥
- âœ… æ—¥æœŸè‡ªåŠ¨åŒæ­¥
- âœ… é¿å…äººä¸ºé”™è¯¯

### 3. å®Œæ•´æ€§
- âœ… æ¯ä¸ªæ´»åŠ¨éƒ½æœ‰è´¢åŠ¡è´¦æˆ·
- âœ… åŒå‘å…³è”ç¡®ä¿æ•°æ®å®Œæ•´
- âœ… ä¾¿äºè¿½è¸ªå’ŒæŸ¥è¯¢

### 4. å®¹é”™æ€§
- âœ… å¦‚æœè´¢åŠ¡è´¦æˆ·åˆ›å»ºå¤±è´¥ï¼Œæ´»åŠ¨ä»ç„¶æˆåŠŸåˆ›å»º
- âœ… å¯ä»¥åç»­æ‰‹åŠ¨è¡¥å……è´¢åŠ¡è´¦æˆ·
- âœ… ä¸å½±å“æ ¸å¿ƒæµç¨‹

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºæ´»åŠ¨
```
1. è®¿é—®ï¼šæ´»åŠ¨ç®¡ç† â†’ åˆ›å»ºæ´»åŠ¨
2. å¡«å†™ï¼š
   - æ´»åŠ¨åç§°ï¼š2025æ˜¥èŠ‚è”æ¬¢æ™šä¼š
   - å¼€å§‹æ—¥æœŸï¼š2025-02-01
   - æè¿°ï¼šæ–°æ˜¥å›¢æ‹œæ´»åŠ¨
3. ä¿å­˜
```

### ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œ
```javascript
// Consoleè¾“å‡º
âœ… [createEvent] Event created: abc123

ğŸ”„ [createEvent] Auto-creating FinanceEvent...

âœ… [createEvent] FinanceEvent created: def456

âœ… [createEvent] Event updated with financialAccount: def456
```

### åˆ›å»ºç»“æœ
```
Event {
  id: "abc123",
  name: "2025æ˜¥èŠ‚è”æ¬¢æ™šä¼š",
  financialAccount: "def456",  // âœ… è‡ªåŠ¨è®¾ç½®
}

FinanceEvent {
  id: "def456",
  eventName: "2025æ˜¥èŠ‚è”æ¬¢æ™šä¼š",
  relatedEventId: "abc123",    // âœ… è‡ªåŠ¨è®¾ç½®
}
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### ä¿®æ”¹çš„æ–‡ä»¶

1. **src/modules/event/services/eventService.ts**
   - `createEvent()` å‡½æ•°å¢å¼º
   - å¯¼å…¥ `createFinanceEvent`
   - æ·»åŠ è‡ªåŠ¨åˆ›å»ºé€»è¾‘
   - æ·»åŠ åŒå‘å…³è”æ›´æ–°

2. **src/modules/finance/types/index.ts**
   - `FinanceEvent` æ¥å£æ‰©å±•
   - æ–°å¢ `relatedEventId` å­—æ®µ
   - æ–°å¢ `relatedEventName` å­—æ®µ

---

## âœ… å‘åå…¼å®¹

### æ—§æ´»åŠ¨ä¸å—å½±å“
- å·²å­˜åœ¨çš„æ´»åŠ¨ä¿æŒä¸å˜
- æ²¡æœ‰è´¢åŠ¡è´¦æˆ·çš„æ´»åŠ¨å¯ä»¥æ‰‹åŠ¨å…³è”
- ä¸ä¼šç ´åç°æœ‰æ•°æ®

### æ–°æ´»åŠ¨è‡ªåŠ¨å…³è”
- åˆ›å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆè´¢åŠ¡è´¦æˆ·
- è‡ªåŠ¨å»ºç«‹åŒå‘å…³è”
- æ— éœ€æ‰‹åŠ¨æ“ä½œ

---

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

### 1. ç¼–è¾‘æ´»åŠ¨æ—¶åŒæ­¥æ›´æ–°
```typescript
// å½“ä¿®æ”¹æ´»åŠ¨åç§°æ—¶ï¼ŒåŒæ­¥æ›´æ–°è´¢åŠ¡è´¦æˆ·åç§°
if (Event.name changed) {
  update FinanceEvent.eventName
  update FinanceEvent.relatedEventName
}
```

### 2. åˆ é™¤æ´»åŠ¨æ—¶å¤„ç†è´¢åŠ¡è´¦æˆ·
```typescript
// é€‰é¡¹Aï¼šåŒæ—¶åˆ é™¤è´¢åŠ¡è´¦æˆ·
// é€‰é¡¹Bï¼šä¿ç•™è´¢åŠ¡è´¦æˆ·ä½†æ ‡è®°ä¸ºorphaned
// é€‰é¡¹Cï¼šæç¤ºç”¨æˆ·é€‰æ‹©
```

### 3. æ‰¹é‡æ›´æ–°æ—§æ•°æ®
```typescript
// ä¸ºç°æœ‰æ´»åŠ¨æ‰¹é‡åˆ›å»ºè´¢åŠ¡è´¦æˆ·
for (const event of eventsWithoutFinanceAccount) {
  await autoCreateFinanceEventForExistingEvent(event);
}
```

---

## ğŸ“‹ æµ‹è¯•æ¸…å•

### æµ‹è¯•1ï¼šåˆ›å»ºæ–°æ´»åŠ¨
- [ ] è®¿é—®æ´»åŠ¨åˆ›å»ºé¡µé¢
- [ ] å¡«å†™åŸºæœ¬ä¿¡æ¯
- [ ] ä¿å­˜
- [ ] æŸ¥çœ‹Consoleï¼Œç¡®è®¤FinanceEventå·²åˆ›å»º
- [ ] è®¿é—®"è´¢åŠ¡ç®¡ç† â†’ æ´»åŠ¨è´¢åŠ¡"
- [ ] ç¡®è®¤æ–°çš„è´¢åŠ¡è´¦æˆ·å·²å‡ºç°

### æµ‹è¯•2ï¼šéªŒè¯åŒå‘å…³è”
- [ ] æ‰“å¼€Firebase Console
- [ ] æŸ¥çœ‹ events é›†åˆ
- [ ] ç¡®è®¤ `financialAccount` å­—æ®µå·²è®¾ç½®
- [ ] æŸ¥çœ‹ financeEvents é›†åˆ
- [ ] ç¡®è®¤ `relatedEventId` å­—æ®µå·²è®¾ç½®

### æµ‹è¯•3ï¼šéªŒè¯è´¹ç”¨è®¾ç½®
- [ ] ç¼–è¾‘åˆšåˆ›å»ºçš„æ´»åŠ¨
- [ ] åˆ‡æ¢åˆ°"è´¹ç”¨è®¾ç½®"æ ‡ç­¾é¡µ
- [ ] ç¡®è®¤"é¡¹ç›®æˆ·å£"ä¸‹æ‹‰åˆ—è¡¨ä¸­æ˜¾ç¤ºäº†è‡ªåŠ¨åˆ›å»ºçš„è´¢åŠ¡è´¦æˆ·
- [ ] ç¡®è®¤å·²è‡ªåŠ¨é€‰ä¸­

---

## ğŸ‰ åŠŸèƒ½å®Œæˆ

ç°åœ¨åˆ›å»ºæ´»åŠ¨æ—¶ï¼š
- âœ… è‡ªåŠ¨åˆ›å»ºè´¢åŠ¡è´¦æˆ·
- âœ… è‡ªåŠ¨å»ºç«‹åŒå‘å…³è”
- âœ… è´¹ç”¨è®¾ç½®è‡ªåŠ¨åŒ¹é…
- âœ… äº¤æ˜“è®°å½•è‡ªåŠ¨å…³è”

**å¤§å¤§ç®€åŒ–äº†æ´»åŠ¨è´¢åŠ¡ç®¡ç†æµç¨‹ï¼** ğŸš€

---

**ç‰ˆæœ¬**: 1.0  
**ä½œè€…**: AI Assistant  
**æœ€åæ›´æ–°**: 2025-01-18

